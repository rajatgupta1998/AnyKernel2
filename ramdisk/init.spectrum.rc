# SPECTRUM KERNEL MANAGER
# Ramdisk file for profile based kernel management
# Implementation inspired by Franco's fku profiles

# Initialization
on property:sys.boot_completed=1
	# Set default profile on first boot
	# Executed under three different contexts to make sure it fires properly
	exec u:r:init:s0 root root -- /init.spectrum.sh
	exec u:r:su:s0 root root -- /init.spectrum.sh
	exec u:r:supersu:s0 root root -- /init.spectrum.sh
	# Enable Spectrum support
	setprop spectrum.support 1
	# Add kernel name
	setprop persist.spectrum.kernel Reviver

# Balance (default profile)
on property:persist.spectrum.profile=0
	# big cluster
	write /sys/devices/system/cpu/cpu0/online 1
	write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "interactive"
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/above_hispeed_delay "0 1440000:20000"
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/go_hispeed_load 94
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_slack 200000
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_rate 50000
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/hispeed_freq 1094400
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/use_sched_load 0
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/target_loads 88
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/min_sample_time 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boostpulse_duration 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boost 0
	# LITTLE cluster
	write /sys/devices/system/cpu/cpu4/online 1
	write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor "interactive"
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/above_hispeed_delay "0 1094400:20000"
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/go_hispeed_load 92
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_slack 160000
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_rate 40000
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/hispeed_freq 998400
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/use_sched_load 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/target_loads 85
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/min_sample_time 20000
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boostpulse_duration 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boost 0
	# GPU
	write /sys/class/kgsl/kgsl-3d0/devfreq/governor msm-adreno-tz

# Performance
on property:persist.spectrum.profile=1
	# big cluster
	write /sys/devices/system/cpu/cpu0/online 1
	write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "interactive"
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/above_hispeed_delay 0
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/go_hispeed_load 87
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_slack 160000
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_rate 40000
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/hispeed_freq 1344000
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/use_sched_load 0
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/target_loads 78
	write /sys/devices/system/cpu/cpu0/cpufreq/interactive/min_sample_time 40000
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boostpulse_duration 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boost 0
	# LITTLE cluster
	write /sys/devices/system/cpu/cpu4/online 1
	write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor "interactive"
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/above_hispeed_delay 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/go_hispeed_load 87
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_slack 120000
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_rate 30000
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/hispeed_freq 998400
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/use_sched_load 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/target_loads 78
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/min_sample_time 30000
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boostpulse_duration 0
	write /sys/devices/system/cpu/cpu4/cpufreq/interactive/boost 0
	# GPU
	write /sys/class/kgsl/kgsl-3d0/devfreq/governor msm-adreno-tz

# Battery
on property:persist.spectrum.profile=2
	# big cluster 
	write /sys/devices/system/cpu/cpu0/online 1
	write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor powersave
	# LITTLE cluster
	write /sys/devices/system/cpu/cpu4/online 1
	write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor powersave
	# GPU
	write /sys/class/kgsl/kgsl-3d0/devfreq/governor msm-adreno-tz

# Gaming
on property:persist.spectrum.profile=3
	# big cluster
	write /sys/devices/system/cpu/cpu0/online 1
	write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor performance
	# LITTLE cluster
	write /sys/devices/system/cpu/cpu4/online 1
	write /sys/devices/system/cpu/cpu4/cpufreq/scaling_governor performance
	# GPU
	write /sys/class/kgsl/kgsl-3d0/devfreq/governor performance
